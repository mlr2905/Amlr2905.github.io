<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>מספרים אקראיים</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            text-align: center;
            background-color: #f0f0f0;
        }
        h1 {
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        select {
            margin-top: 20px;
            padding: 10px;
            font-size: 16px;
        }
        button {
            margin-top: 20px;
            padding: 10px;
            background-color: #007bff;
            color: #fff;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 50px;
            height: 50px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        button:hover {
            background-color: #0056b3;
        }
        .export-buttons {
            margin-top: 20px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        .export-buttons img {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: #fff;
            padding: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        .tables {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
        }
        .table {
            border-collapse: collapse;
            margin: 10px;
            background: #fff;
            border-radius: 10px;
            border: 2px solid #007bff;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            max-width: 200px;
            overflow: hidden;
        }
        .table td {
            padding: 5px;
            text-align: center;
        }
        .line {
            padding: 10px;
            background: #f9f9f9;
            border-radius: 5px;
        }
        .number-list {
            list-style-type: none;
            padding: 0;
            display: flex;
            justify-content: center;
            gap: 10px;
        }
        .number-list li {
            background-color: #007bff;
            color: #fff;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: bold;
        }
        .special-number {
            font-size: 18px;
            font-weight: bold;
            color: #fff;
            background-color: red;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 10px auto;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .refresh-button {
            padding: 5px 10px;
            background-color: #28a745;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }
        .refresh-button:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>טופס לוטו</h1>
         <select id="linesCount">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
            <option value="5">5</option>
            <option value="6">6</option>
            <option value="7">7</option>
        </select>
      <span><b>:כמות קוביות</b></span>
        <div class="tables" id="tablesContainer"></div>
        <div class="export-buttons">
            <button onclick="exportToPDF()">
                <img src="https://helpx.adobe.com/content/dam/help/mnemonics/acrobat_dc_app_RGB.svg" alt="PDF">
            </button>
            <button onclick="exportToExcel()">
                <img src="https://cdn-dynmedia-1.microsoft.com/is/image/microsoftcorp/Blade005_3-Up%20Icon%20Card_Excel_24x22_2x?resMode=sharp2&op_usm=1.5,0.65,15,0&wid=64&hei=64&qlt=100&fmt=png-alpha&fit=constrain" alt="Excel">
            </button>
            <button onclick="sendToWhatsApp()">
                <img src="https://smart.fnx.co.il/Images/Footer/whatsapp.svg" alt="WhatsApp">
            </button>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.2/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <script>
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateLine() {
            const numbers_1_to_37 = new Set();
            while (numbers_1_to_37.size < 6) {
                numbers_1_to_37.add(getRandomInt(1, 37));
            }
            const numbersArray = Array.from(numbers_1_to_37);
            const number_1_to_7 = getRandomInt(1, 7);

            const line = document.createElement('tr');
            line.className = 'line';
            line.innerHTML = `
                <td colspan="3">
                    <ul class="number-list">${numbersArray.map(number => `<li>${number}</li>`).join('')}</ul>
                </td>
                <td>
                    <div class="special-number">${number_1_to_7}</div>
                </td>
                <td>
                    <button class="refresh-button" onclick="refreshLine(this)">רענן</button>
                </td>
            `;
            return line;
        }

        function refreshLine(button) {
            const line = button.closest('tr');
            const newLineContent = generateLineContent();
            line.innerHTML = '';
            line.appendChild(newLineContent);
        }

        function generateLineContent() {
            const numbers_1_to_37 = new Set();
            while (numbers_1_to_37.size < 6) {
                numbers_1_to_37.add(getRandomInt(1, 37));
            }
            const numbersArray = Array.from(numbers_1_to_37);
            const number_1_to_7 = getRandomInt(1, 7);

            const content = document.createDocumentFragment();

            const tdNumbers = document.createElement('td');
            tdNumbers.colSpan = 3;
            const ul = document.createElement('ul');
            ul.className = 'number-list';
            numbersArray.forEach(number => {
                const li = document.createElement('li');
                li.textContent = number;
                ul.appendChild(li);
            });
            tdNumbers.appendChild(ul);
            content.appendChild(tdNumbers);

            const tdSpecial = document.createElement('td');
            const specialDiv = document.createElement('div');
            specialDiv.className = 'special-number';
            specialDiv.textContent = number_1_to_7;
            tdSpecial.appendChild(specialDiv);
            content.appendChild(tdSpecial);

            const tdButton = document.createElement('td');
            const refreshButton = document.createElement('button');
            refreshButton.className = 'refresh-button';
            refreshButton.textContent = 'רענן';
            refreshButton.onclick = function() {
                refreshLine(refreshButton);
            };
            tdButton.appendChild(refreshButton);
            content.appendChild(tdButton);

            return content;
        }

        function generateTables() {
            const tablesContainer = document.getElementById('tablesContainer');
            tablesContainer.innerHTML = '';
            const linesCount = parseInt(document.getElementById('linesCount').value, 10);

            for (let i = 0; i < linesCount; i++) {
                const table = document.createElement('table');
                table.className = 'table';
                for (let j = 0; j < 2; j++) {
                    const row = generateLine();
                    table.appendChild(row);
                }
                tablesContainer.appendChild(table);
            }
        }

        function exportToPDF() {
            const element = document.querySelector('.container');
            html2pdf().from(element).save('lotto-numbers.pdf');
        }

        function exportToExcel() {
            const tables = document.querySelectorAll('.table');
            const data = [];
            tables.forEach(table => {
                const rows = table.querySelectorAll('tr');
                rows.forEach(row => {
                    const numbers = Array.from(row.querySelectorAll('.number-list li')).map(li => li.textContent).join(',');
                    const special = row.querySelector('.special-number')?.textContent;
                    data.push([numbers, special].join(','));
                });
            });

            const ws = XLSX.utils.aoa_to_sheet(data.map(row => row.split(',')));
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'Numbers');
            XLSX.writeFile(wb, 'lotto-numbers.xlsx');
        }

        function sendToWhatsApp() {
            const tables = document.querySelectorAll('.table');
            let message = 'המספרים האקראיים:\n\n';
            tables.forEach(table => {
                const rows = table.querySelectorAll('tr');
                rows.forEach(row => {
                    const numbers = Array.from(row.querySelectorAll('.number-list li')).map(li => li.textContent).join(', ');
                    const special = row.querySelector('.special-number')?.textContent;
                    message += `מספרים: ${numbers} - מספר חזק: ${special}\n`;
                });
                message += '\n';
            });
            const encodedMessage = encodeURIComponent(message);
            window.open(`https://wa.me/?text=${encodedMessage}`, '_blank');
        }

        document.getElementById('linesCount').addEventListener('change', generateTables);
        window.onload = generateTables;
    </script>
</body>
</html>
